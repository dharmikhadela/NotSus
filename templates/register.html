{% extends "base.html" %}

{% block head %}
<title>Register</title>
{% endblock %}

{% block body %}
    <div style="margin: auto; width:40%">
        <h1 style="color:white; text-align:center;">NOTSUS</h1>
    </div>
    <div style="margin:auto; width:40%; background-color:white; border-radius:5px; box-shadow:2px 2px 4px; padding:12px">
        <h2>Register</h2>
        <form id="registerForm">
            <label for="username">Username</label><br/>
            <input type="text" id="username" name="username" required><br/>
            <label for="password">Password</label><br/>
            <input type="password" id="password" name="password" required><br/>
            <input type="submit" value="Submit" style="background-color: lightgray; border-radius:4px; border: 2px solid slategray">
        </form>
        <div id="responseMessage"></div>
    </div>

    <script>
        document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const formData = new FormData(this);

        fetch('/register', {
            method: 'POST',
            body: formData
        })
        .then(async response => {
            const data = await response.json();

            if (!response.ok) {
                throw new Error(data.message || "Something went wrong");
            }

            document.getElementById('responseMessage').innerHTML =
                '<p style="color: green;">' + data.message + '</p>';
        })
        .catch(error => {
            document.getElementById('responseMessage').innerHTML =
                '<p style="color: red;">' + error.message + '</p>';
        });
    });
    </script>
{% endblock %}
